
<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ä¸­æ–‡å£èªå³æ™‚æ¯”å°ï¼ˆå…§å»ºè©è¡¨ç‰ˆï¼‰</title>
  <style>
    body { font-family: "Microsoft JhengHei", Arial, sans-serif; background:#fafafa; margin:0; padding:20px; }
    .container { max-width: 980px; margin:0 auto; background:#fff; padding:20px; border-radius:12px; box-shadow:0 0 10px rgba(0,0,0,.08); }
    h1 { text-align:center; margin-top:0; color:#333; }
    h2 { margin-top:28px; }
    select, button, input[type="text"] { padding:8px 12px; margin:5px; font-size:16px; }
    .sentence { font-size:20px; text-align:center; margin:20px 0; padding:10px; background:#f1f1f1; border-radius:8px; }
    #result, #diff, #quizDiff, .box { padding:10px; margin-top:10px; background:#f9f9f9; border:1px solid #ddd; min-height:30px; border-radius:8px; }
    .row { margin:6px 0; }
    .label { color:#666; font-size:14px; margin-right:6px; }
    .highlight { background:yellow; font-weight:bold; }
    .ok { background:rgba(22,163,74,.12); }
    .note { color:#6b7280; font-size:12px; }
    .scoreRow { display:flex; align-items:center; gap:12px; flex-wrap:wrap; }
    #feedback { color:#374151; font-size:15px; }
    .muted { color:#6b7280; }
    .flex { display:flex; gap:20px; flex-wrap:wrap; }
    .col { flex:1 1 380px; }
    table { width:100%; border-collapse:collapse; }
    th, td { border-bottom:1px solid #eaeaea; padding:8px; text-align:left; vertical-align:top; }
    .actions { display:flex; gap:8px; flex-wrap:wrap; align-items:center; }
    .em { font-weight:600; }
    .pill { display:inline-block; background:#eef2ff; padding:2px 8px; border-radius:999px; font-size:12px; margin:2px 6px 2px 0; }
    .list { display:flex; flex-wrap:wrap; }
    .two { display:grid; grid-template-columns: 1fr 1fr; gap: 12px; }
    .wide { width:100%; }
  </style>
</head>
<body>
  <div class="container">
    <h1>ä¸­æ–‡å£èªå³æ™‚æ¯”å°ï¼ˆå…§å»ºè©è¡¨ç‰ˆï¼‰</h1>

    <div class="box two">
      <div>
        <label class="label">å§“åï¼š</label>
        <input type="text" id="studentName" placeholder="å¯ç•™ç©º" class="wide" />
      </div>
      <div>
        <label class="label">å­¸è™Ÿï¼š</label>
        <input type="text" id="studentId" placeholder="å¯ç•™ç©º" class="wide" />
      </div>
    </div>

    <h2>é¸æ“‡èª²æ¬¡ï¼ˆå¯è¤‡é¸ï¼‰</h2>
    <div class="box">
      <div class="actions">
        <select id="lessonMulti" multiple size="8" class="wide"></select>
        <div>
          <button onclick="selectAllLessons()">å…¨é¸</button>
          <button onclick="clearLessons()">æ¸…ç©º</button>
        </div>
      </div>
      <div class="note">æç¤ºï¼šæŒ‰ä½ Ctrl/âŒ˜ æˆ–æ‹–æ›³å¯å¤šé¸ï¼›æˆ–ä½¿ç”¨ã€Œå…¨é¸ï¼æ¸…ç©ºã€ã€‚</div>
      <div class="note">èª²æ¬¡èˆ‡å¥æ•¸ï¼š</div>
      <div id="lessonStats" class="list"></div>
    </div>

    <div class="flex">
      <div class="col">
        <h2>ç·´ç¿’</h2>
        <div class="actions">
          <button onclick="newSentence()">æ›ä¸€å¥</button>
        </div>

        <div class="sentence" id="sentence">è«‹æŒ‰ã€Œæ›ä¸€å¥ã€ç”Ÿæˆå¥å­ï¼ˆéœ€å…ˆé¸èª²ï¼‰</div>

        <div class="actions">
          <button id="btnStart" onclick="startRecognition()">ğŸ™ï¸ é–‹å§‹éŒ„éŸ³</button>
          <button id="btnStop" onclick="stopRecognition()" disabled>â–  çµæŸéŒ„éŸ³</button>
          <button onclick="playSentence()">ğŸ”Š ç¤ºç¯„ç™¼éŸ³</button>
        </div>

        <h3>è¾¨è­˜çµæœï¼š</h3>
        <div id="result">å°šç„¡çµæœ</div>

        <h3>å·®ç•°é«˜å…‰ï¼š</h3>
        <div id="diff">å°šç„¡çµæœ</div>
        <div class="note">èªªæ˜ï¼šç¶ åº•ç‚ºä¸€è‡´ï¼Œé«˜å…‰ç‚ºä¸åŒï¼›ä¾‹å¥ç¼ºæ¼ä»¥ <b>âˆ…</b> é¡¯ç¤ºï¼Œè¾¨è­˜å¤šå”¸æœƒåœ¨ã€Œè¾¨è­˜ã€è¡Œä»¥é«˜å…‰é¡¯ç¤ºã€‚</div>

        <h3>æ­£ç¢ºç‡ï¼š</h3>
        <div class="scoreRow">
          <div id="accuracy">â€”</div>
          <div id="feedback"></div>
          <button id="btnDownload" onclick="downloadTxt()">â¬‡ï¸ ä¸‹è¼‰æˆç¸¾ï¼ˆTXTï¼‰</button>
        </div>
      </div>

      <div class="col">
        <h2>æ¸¬é©—ï¼ˆå¾æ‰€é¸èª²æ¬¡æŠ½é¡Œï¼Œå…± 3 é¡Œï¼‰</h2>
        <div class="box">
          <div class="muted">ç‹€æ…‹ï¼š<span id="quizState">æœªé–‹å§‹</span></div>
          <div class="sentence" id="quizSentence">ï¼ˆé–‹å§‹å¾Œé¡¯ç¤ºæœ¬é¡Œå¥å­ï¼‰</div>

          <div class="actions">
            <button onclick="startQuiz()">é–‹å§‹æ¸¬é©—ï¼ˆ3é¡Œï¼‰</button>
            <button onclick="quizPlay()">ğŸ”Š ç¤ºç¯„ç™¼éŸ³</button>
            <button id="btnQuizStart" onclick="quizRecord()">ğŸ™ï¸ é–‹å§‹éŒ„éŸ³</button>
            <button id="btnQuizStop" onclick="quizStop()" disabled>â–  çµæŸéŒ„éŸ³</button>
            <button onclick="quizSubmit()">æäº¤æœ¬é¡Œ</button>
          </div>

          <div class="row"><span class="label">æœ¬é¡Œè¾¨è­˜ï¼š</span><span id="quizHeard">â€”</span></div>
          <div id="quizDiff">ï¼ˆé«˜å…‰å·®ç•°æœƒé¡¯ç¤ºåœ¨é€™è£¡ï¼‰</div>
        </div>

        <div id="quizSummary" class="box" style="display:none;">
          <h3>æœ¬æ¬¡æ¸¬é©—çµæœ</h3>
          <div class="row">ç¸½æ­£ç¢ºç‡ï¼š<b id="quizTotal">â€”</b></div>
          <div class="row">ç¸½è©•ï¼ˆä¸­ / ENï¼‰ï¼š<span id="quizFeedback" class="em">â€”</span></div>
          <div class="row">å§“å / å­¸è™Ÿï¼š<span id="quizWho" class="em">â€”</span></div>
          <div class="actions">
            <button onclick="downloadQuizTXT()">â¬‡ï¸ ä¸‹è¼‰æœ¬æ¬¡ï¼ˆTXTï¼‰</button>
            <button onclick="downloadQuizCSV()">â¬‡ï¸ ä¸‹è¼‰æœ¬æ¬¡ï¼ˆCSVï¼‰</button>
          </div>

          <h4>è¾¨è­˜æ¯”å°è¡¨ï¼ˆ3é¡Œï¼‰</h4>
          <table id="quizTable">
            <thead>
              <tr>
                <th style="width:40px;">é¡Œ</th>
                <th>ä¾‹å¥ / è¾¨è­˜ï¼ˆé›™è¡Œé«˜å…‰ï¼‰</th>
                <th style="width:80px;">æ­£ç¢ºç‡</th>
              </tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>
      </div>
    </div>
  </div>

<script>
  const lessons = {
  "1": [
    "èµ°",
    "è·¯äºº",
    "å¹«å¿™",
    "è¿·è·¯",
    "ä¸‹",
    "è·¯å£",
    "æ®µ",
    "é",
    "ç¬¬",
    "ç´…ç¶ ç‡ˆ",
    "å‘Šè¨´",
    "ææ¬¾æ©Ÿ",
    "è¶…å•†",
    "æ‡‰è©²",
    "éƒµå±€",
    "æ",
    "é‚£é‚Š",
    "å¸«å¤§ï¼ˆå¸«ç¯„å¤§å­¸ï¼‰",
    "å’Œå¹³æ±è·¯",
    "å¾€å‰",
    "å³è½‰",
    "è½èµ·ä¾†",
    "çœ‹è¦‹",
    "ä¸‹è¼‰",
    "åœ°åœ–",
    "å¥½ç”¨",
    "è‘—",
    "æ—¥ç”¨å“",
    "ç¶“é",
    "å··å­",
    "é¤“",
    "ä¸€é‚Š",
    "ç™¼ç¾",
    "é›¢",
    "èƒŒåŒ…",
    "æ­£å¥½",
    "æœ€å¾Œ",
    "æ",
    "ç­†",
    "æœ¬",
    "æœ¬å­",
    "å·¦è½‰",
    "å¸«å¤§è·¯ä¸Š",
    "éºµåº—"
  ],
  "2": [
    "é‚„æ˜¯",
    "æ—©",
    "ç´„",
    "å°é¢",
    "ç›´æ¥",
    "ä¸å¿…",
    "æ›",
    "è»Šç«™",
    "éº»ç…©",
    "è¶•å¿«",
    "ç­‰",
    "è½‰",
    "ä¸‹è»Š",
    "ä¸Šè»Š",
    "ç«™ç‰Œ",
    "æ¨“æ¢¯",
    "é›»æ¢¯",
    "æ‰‹æ‰¶æ¢¯",
    "å”®ç¥¨æ©Ÿ",
    "å”®ç¥¨å£",
    "å‡ºå£",
    "å‰é¢",
    "æ—é‚Š",
    "æ‹å½",
    "ç´…ç¶ ç‡ˆ",
    "å·¦è½‰",
    "å³è½‰",
    "ç›´èµ°",
    "å‰å¾€",
    "è·¯ç·š",
    "åœ°åœ–",
    "æŸ¥è©¢",
    "æ‰“é–‹",
    "é—œæ‰",
    "ä¸å¥½æ„æ€",
    "å•è·¯",
    "å¹«å¿™",
    "æ­",
    "èˆ¹",
    "åœ°",
    "ç¾ç¾",
    "æ³•åœ‹",
    "æ­æ´²",
    "æ‚ éŠå¡",
    "ç¶ å³¶",
    "æ±å—é‚Š",
    "å¥½å¥½åœ°"
  ],
  "3": [
    "é€²æ­¥",
    "æ—©",
    "è€ƒè©¦",
    "æº–å‚™",
    "è€ƒ",
    "è½å¯«",
    "å®¹æ˜“",
    "å°å­¸",
    "æ¼¢å­—",
    "é«˜ä¸­",
    "é",
    "æ‰",
    "èªªè©±",
    "ä¸å¤ ",
    "æµåˆ©",
    "é›–ç„¶",
    "å› ç‚º",
    "æ‰€ä»¥",
    "èªçœŸ",
    "ä¸Šèª²",
    "è½",
    "èª²æ–‡",
    "ç”Ÿè©",
    "ç™¼éŸ³",
    "å¯«",
    "ç·´ç¿’",
    "ä½œæ¥­",
    "æ™‚é–“",
    "åŠå¤œ",
    "é«˜èˆˆ",
    "å¹³å¸¸",
    "çˆ¬å±±",
    "èªè­˜",
    "èŠå¤©",
    "æ–‡åŒ–",
    "å»£å‘Š",
    "ä½",
    "äº†è§£",
    "ç”Ÿæ´»",
    "é™½æ˜å±±",
    "å¤–åœ‹äºº",
    "ä¸€äº›",
    "æ™¯è‰²",
    "é¢¨æ™¯",
    "å–œæ­¡",
    "å¸¶",
    "ç›¸æ©Ÿ",
    "æ‹ç…§",
    "æ—…è¡Œ",
    "è¨ˆç•«",
    "åœ°æ–¹",
    "åœ°é»",
    "åœ°ç†",
    "é–€ç¥¨",
    "è²»ç”¨",
    "å",
    "è»Š",
    "å¤§çœ¾äº¤é€š",
    "æ­¥è¡Œ",
    "å®‰å…¨"
  ],
  "4": [
    "é«˜ç¾ç²",
    "æ‰“å·¥",
    "ä¸»ä»»",
    "ä»‹ç´¹",
    "æ­²",
    "èªè¨€å­¸",
    "ç¶“é©—",
    "è«‡",
    "ç•¶",
    "åŠ©æ•™",
    "ä¸Šåˆ",
    "é™¤äº†",
    "å¹´ç´š",
    "æš‘å‡",
    "è«‹æ•™",
    "æ–‡åŒ–",
    "ç¶“æ­·",
    "å±¥æ­·è¡¨",
    "é¢è«‡",
    "è¯åƒ‘",
    "è¾¦å…¬å®¤",
    "è«‡è©±",
    "æƒ…å½¢",
    "é©åˆ",
    "èªªæ˜",
    "ç„¶å¾Œ",
    "æœˆåº•",
    "ç™¼",
    "é¦¬ä¸Š",
    "ç­”æ‡‰",
    "é †åˆ©",
    "é»ƒ",
    "æ²’æƒ³åˆ°",
    "æ©Ÿæœƒ",
    "æº–å‚™",
    "èƒ½åŠ›",
    "åƒåŠ ",
    "æ¨è–¦ä¿¡",
    "ç”³è«‹",
    "ç³»æ‰€",
    "çå­¸é‡‘",
    "è¨ˆç•«",
    "å ±å",
    "è³‡æ–™",
    "æ–‡ä»¶"
  ],
  "5": [
    "å–œé…’",
    "æ­å–œ",
    "æ–°å¨˜",
    "åƒåŠ ",
    "å©šç¦®",
    "è¥¿è£",
    "æ­£å¼",
    "å®¢äºº",
    "æ‰‹",
    "ç…§ç›¸æ©Ÿ",
    "æ–°éƒ",
    "ç«™",
    "ç™½",
    "å¸¥",
    "ç¦®æœ",
    "åŒ–å¦",
    "æ§èŠ±",
    "ç¿»",
    "ç¥è³€",
    "æˆ¿",
    "æ–°æˆ¿",
    "æº–å‚™",
    "å¸­",
    "æ¡Œ",
    "å¤§é–€",
    "å¸­ä½",
    "è¬å¡",
    "è‡´è©",
    "å–œå®´",
    "æ•¬é…’",
    "å¤§äºº",
    "å°å­©",
    "ä¸å¾—äº†",
    "å¦å¤–",
    "ç³–",
    "é›¢é–‹",
    "å¥",
    "ç¥ç¦",
    "è©±",
    "ä¸€æœƒå…’",
    "æœ‰èªªæœ‰ç¬‘",
    "æœ‰åƒæœ‰å–",
    "ç™¾å¹´å¥½åˆ",
    "æ—©ç”Ÿè²´å­"
  ],
  "6": [
    "ææ±å¥",
    "æ¬",
    "æ²³é‚Š",
    "å…¬åœ’",
    "è…³è¸è»Š",
    "è·¯",
    "æ£Ÿ",
    "é‚„å¥½",
    "é„°å±…",
    "é¡˜æ„",
    "ç•¶",
    "å¹«å¿™",
    "å¸¶",
    "æ…¢æ…¢ä¾†",
    "ç”¨",
    "å€Ÿ",
    "ä¸ç”¨",
    "æ–¹ä¾¿",
    "é˜é ­",
    "åˆ†é˜",
    "è¶•æ™‚é–“",
    "ä¸å¿…",
    "å°æ™‚",
    "ç¤¾å€",
    "ç’°å¢ƒ",
    "å®‰éœ",
    "é™„è¿‘",
    "ç†±é¬§",
    "è¯èª",
    "ä¸­å¿ƒ",
    "æ´—è¡£æ©Ÿ",
    "è‡¥å®¤",
    "æ›¸æ¡Œ",
    "è¡£æ«ƒ",
    "æ¤…å­",
    "å®¢å»³",
    "æ²™ç™¼",
    "èŒ¶å‡ ",
    "é¤æ¡Œ",
    "å®¶å…·",
    "æ°´é›»",
    "ç“¦æ–¯",
    "è²»",
    "åŒ…",
    "ç¶²è·¯",
    "æˆ¿æ±",
    "åˆç´„"
  ],
  "7": [
    "åƒåœ¾",
    "å€’",
    "ä¸Ÿ",
    "æ”¶",
    "ä»¥ç‚º",
    "çµæœ",
    "åˆ†é¡",
    "éº»ç…©",
    "è¢‹å­",
    "ä¸€æ¨£",
    "çš®åŒ…",
    "å¿˜è¨˜",
    "èµ°éå»",
    "èµ°éä¾†",
    "éå»",
    "éä¾†",
    "å›ä¾†",
    "å›å»",
    "æ‹¿",
    "åŒ…åŒ…",
    "è£",
    "å£è¢‹",
    "ä¸Ÿé€²å»",
    "é«’",
    "è¨˜å¾—",
    "ä¸è¦‹",
    "å¸Œæœ›",
    "è‡ªç”±",
    "ä¸€é‚Š",
    "æƒ³èµ·ä¾†",
    "è¢‹",
    "æ•´ç†",
    "ç“¶å­",
    "ç´™æ¯",
    "é£²æ–™",
    "å–å®Œ",
    "ä¸Ÿæ‰",
    "æ‡‰è©²",
    "æ‰",
    "ä¸é",
    "å¸¸å¸¸",
    "äº‚",
    "ä»¥å¾Œ",
    "ç¿’æ…£"
  ],
  "8": [
    "åŠ ç­",
    "äº¤é€š",
    "æ–¹ä¾¿",
    "é„°å±…",
    "ç’°å¢ƒ",
    "æˆ¿æ±",
    "è¡Œæ",
    "åƒè§€",
    "ç·Šå¼µ",
    "ç¿’æ…£",
    "åœ°éµ",
    "è¶…å¸‚",
    "ç§Ÿ",
    "æ¬å®¶",
    "æ•´ç†",
    "é«”é©—",
    "èªè­˜",
    "å‚³çµ±",
    "æ–‡åŒ–",
    "åƒåŠ ",
    "æ´»å‹•",
    "å®‰æ’",
    "åœ°æ–¹",
    "ç†±é¬§",
    "ç‰¹åˆ¥",
    "è¡¨æ¼”",
    "æº–å‚™",
    "æ„Ÿè¦º",
    "ç²¾å½©",
    "è¨˜å¾—",
    "æ‹ç…§",
    "åˆ†äº«"
  ],
  "9": [
    "æ˜¥å‡",
    "å¥½",
    "åˆ°",
    "ç‰¹è‰²",
    "å¤ ",
    "ä¸‹æ¬¡",
    "è¨˜å¾—",
    "åŠŸèª²",
    "å ±å‘Š",
    "æ”¾å‡",
    "æ‰“ç®—",
    "å®‰æ’",
    "åœ°æ–¹",
    "å—éƒ¨",
    "åŒ—éƒ¨",
    "ä¸­éƒ¨",
    "æ±éƒ¨",
    "è¥¿éƒ¨",
    "æµ·é‚Š",
    "å±±ä¸Š",
    "é è¨‚",
    "æ—…é¤¨",
    "æ°‘å®¿",
    "éœ€è¦",
    "è¨‚",
    "ç¶²è·¯",
    "è¨‚ä¸åˆ°",
    "æœ‰å",
    "ç†±é–€",
    "æ¨è–¦",
    "å¹«å¿™",
    "æ³¨æ„",
    "è‡ªç”±è¡Œ",
    "æ—…è¡Œç¤¾",
    "è·Ÿåœ˜",
    "åƒè§€",
    "æ™¯é»",
    "é¢¨æ™¯",
    "ç…§ç›¸",
    "é–‹è»Š",
    "åœ°éµ",
    "æ­",
    "é‚„æ˜¯"
  ],
  "10": [
    "é¦¬ä¸",
    "åŒ…",
    "é¤ƒå­",
    "è„«",
    "é‹",
    "é—œ",
    "é–€",
    "æ˜¥æ²",
    "æ³¡èœ",
    "é£¯å»³",
    "ä¸‹",
    "æ´—",
    "åšèœ",
    "æ°´é¤ƒ",
    "ç…®",
    "å£",
    "ç ´",
    "é¤¡å…’",
    "æ‰",
    "ææ–™",
    "é“",
    "é£½",
    "å…‰",
    "é‹å­",
    "ç­·å­",
    "ç¢—",
    "éŸ“åœ‹",
    "çœ‹ä¸å‡ºä¾†",
    "é…¸è¾£æ¹¯",
    "å­¸æœŸ",
    "è¶",
    "çš®",
    "åš",
    "å¤§ç™½èœ",
    "åŠ ",
    "é¹½",
    "æ‹Œ",
    "è¾£æ¤’",
    "èª¿å‘³æ–™",
    "è£",
    "ç»ç’ƒ",
    "å£½å¸",
    "åƒ",
    "é£Ÿç‰©",
    "åšèµ·ä¾†"
  ],
  "11": [
    "å…¶ä»–",
    "å‡æœŸ",
    "æº«æ³‰",
    "å»ºè­°",
    "ç¥¨",
    "è€ƒæ…®",
    "é †ä¾¿",
    "æ¹–",
    "åŸä½æ°‘",
    "è¶Ÿ",
    "å¾Œä¾†",
    "æ³¨æ„",
    "æ²™ç˜",
    "éŒ¢åŒ…",
    "ä¸è¦‹",
    "è¢«",
    "å·",
    "å®‰å…¨",
    "å€¼å¾—",
    "å¢¾ä¸",
    "å°ä¸­",
    "æ—¥æœˆæ½­",
    "æ°´ä¸Šæ´»å‹•",
    "é¢¨æ™¯å€",
    "åˆ",
    "é",
    "æ°‘å®¿",
    "é‹æ°£",
    "æ‘©æ‰˜è»Š",
    "ç†±å¸¶",
    "æ¤ç‰©",
    "æ‰€æœ‰",
    "ç™½å¤©",
    "èºº",
    "é»ƒæ˜",
    "æ¢",
    "è¡—",
    "å•¤é…’",
    "ä¸Š",
    "æµªæ¼«",
    "å®¶é„‰",
    "è§€å…‰å®¢",
    "æ›¬å¤ªé™½",
    "æ°´ä¸Šæ‘©æ‰˜è»Š",
    "æ„›ä¸Š"
  ],
  "12": [
    "æ–°",
    "é–‹",
    "ç´ é£Ÿ",
    "é€Ÿé£Ÿ",
    "éŒ¯",
    "è‚‰",
    "æ¬¸",
    "è®“",
    "åƒç´ ",
    "æ¼¢å ¡",
    "è®Š",
    "èƒ–",
    "ç´ èœ",
    "æ²¹è†©",
    "æ¨£",
    "å¥½å¥‡",
    "å¥³å­©",
    "é’èœ",
    "ç˜¦",
    "å®¤å‹",
    "è±¬è‚‰",
    "è¥¿æ–¹",
    "å®Œå…¨",
    "é¹¹",
    "ç‚¸",
    "çƒ¤",
    "æ²™æ‹‰",
    "éº¥ç•¶å‹",
    "é€Ÿé£Ÿåº—",
    "åªè¦",
    "è¨å­",
    "é¤",
    "å®—æ•™",
    "é—œä¿‚",
    "è–¯æ¢",
    "ä½œæ³•",
    "è¶Š",
    "ç°¡å–®",
    "è’¸",
    "æœ‰æ©Ÿ",
    "é£Ÿå“",
    "åœ°çƒ",
    "æ±™æŸ“",
    "åš´é‡",
    "è¡›ç”Ÿ",
    "ç‡Ÿé¤Š",
    "ä»€éº¼çš„"
  ],
  "13": [
    "æ—æ„›éº—",
    "æ‰",
    "ä½é ­",
    "å‚³",
    "é",
    "ç°¡è¨Š",
    "åŠŸèƒ½",
    "ç”Ÿæ°£",
    "å«",
    "ç½µ",
    "å¥èº«æˆ¿",
    "å•¦",
    "æŸ¥",
    "ç­æ©Ÿ",
    "è¨‚ä½",
    "é›»",
    "å……é›»",
    "ç³Šå¡—",
    "å–”",
    "ç¾©å¤§åˆ©",
    "æ‹¿èµ°",
    "æ’¿åˆ°",
    "ç•™ä¸‹",
    "ç¶²è·¯",
    "ç™¼ç”Ÿ",
    "äº‹æƒ…",
    "æ¶ˆæ¯",
    "é€é",
    "ä¸–ç•Œ",
    "ç¯€çœ",
    "èµ·åºŠ",
    "æª¢æŸ¥",
    "éƒµä»¶",
    "ç«‹åˆ»",
    "ä¸Šå‚³",
    "æ­£å¸¸",
    "è«‡",
    "ç¾ä»£äºº",
    "æ¯”æ–¹èªª",
    "åšåˆ°",
    "ç¬¬ä¸€æ‰‹",
    "æ€¥è‘—",
    "æ‰“æ‹›å‘¼",
    "é¢å°é¢"
  ],
  "14": [
    "å°‡ä¾†",
    "å¾µæ±‚",
    "æ•™å¸«",
    "èªç‚º",
    "ç•¢æ¥­",
    "ç™¼å±•",
    "é€£",
    "æƒ³æ³•",
    "ä¸ä½†",
    "ç¹¼çºŒ",
    "ä½¿ç”¨",
    "å¯¦ç¾",
    "æ‹›å¾…",
    "ç ”ç©¶æ‰€",
    "èš",
    "é¦™æ¸¯",
    "ä¸Šæµ·",
    "èªªåˆ°",
    "å¿µå®Œ",
    "åˆ†å…¬å¸",
    "æ¨ä¸å¾—",
    "èšä¸€èš",
    "ç•¶æ™‚",
    "è²èª¿",
    "ç™¼éŸ³",
    "æº–",
    "ä¼æ¥­",
    "ç®¡ç†",
    "ç³»",
    "ç¶“æ¿Ÿ",
    "å¹«åŠ©",
    "æœ‰é—œ",
    "èªæ³•",
    "ç ”ç©¶",
    "æ•™æ›¸",
    "æ–¹æ³•",
    "ç›®çš„",
    "åœ‹éš›",
    "ç¿»è­¯",
    "å¤–äº¤",
    "äººå“¡",
    "å……å¯¦",
    "å°ˆæ¥­",
    "èƒ½åŠ›",
    "åŠ æ‹¿å¤§",
    "ä¼æ¥­ç®¡ç†ç³»ï¼ˆä¼ç®¡ç³»ï¼‰",
    "åœ‹éš›é—œä¿‚"
  ],
  "15": [
    "æ˜¥ç¯€",
    "ä¼¯ä¼¯",
    "å¹´å¤œé£¯",
    "æ‰“æ“¾",
    "å¥³å…’",
    "åœ‹å¤–",
    "åœçˆ",
    "æ„æ€",
    "å…¨å®¶",
    "å­©å­",
    "å‰ç¥¥",
    "å¹´ç´€",
    "éå¹´",
    "é™¤å¤•å¤œ",
    "ç¡è‘—",
    "å£“æ­²éŒ¢",
    "æ­å–œç™¼è²¡",
    "å¥½äº†",
    "ç¯€æ—¥",
    "æ‰“æƒ",
    "å¦å¤–",
    "æ˜¥è¯",
    "é™¤å¤•",
    "å¹´ç³•",
    "æ©˜å­",
    "å®ˆæ­²",
    "èªªæ³•",
    "æ™š",
    "æ´»",
    "å¹³å®‰",
    "å‡ºé–€",
    "æ‹œå¹´",
    "åˆ",
    "èµ·ä¾†",
    "è¯äºº",
    "è²¼ä¸Š",
    "å¹´å¹´æœ‰é¤˜",
    "æ­¥æ­¥é«˜å‡",
    "å¤§å‰å¤§åˆ©",
    "æ”¾é­ç‚®",
    "å¤§å¹´åˆä¸€",
    "å¤§å¹´åˆäº”"
  ]
};

  function nowString(){ const t=new Date(),p=n=>String(n).padStart(2,'0'); return `${t.getFullYear()}-${p(t.getMonth()+1)}-${p(t.getDate())} ${p(t.getHours())}:${p(t.getMinutes())}:${p(t.getSeconds())}`; }
  function normalize(str){ if(!str) return ""; return str.replace(/[\s\p{P}\p{S}]/gu,'').replace(/[ï¼¡-ï¼ºï½-ï½šï¼-ï¼™]/g,s=>String.fromCharCode(s.charCodeAt(0)-0xFEE0)); }
  function diffAlign(aRaw,bRaw){
    const a=normalize(aRaw), b=normalize(bRaw), n=a.length, m=b.length;
    const dp=Array.from({length:n+1},()=>Array(m+1).fill(0));
    const bt=Array.from({length:n+1},()=>Array(m+1).fill(null));
    for(let i=0;i<=n;i++){ dp[i][0]=i; bt[i][0]='U'; }
    for(let j=0;j<=m;j++){ dp[0][j]=j; bt[0][j]='L'; }
    for(let i=1;i<=n;i++){ for(let j=1;j<=m;j++){
      const cost=a[i-1]===b[j-1]?0:1;
      const d=dp[i-1][j-1]+cost, u=dp[i-1][j]+1, l=dp[i][j-1]+1;
      const best=Math.min(d,u,l); dp[i][j]=best; bt[i][j]=best===d?'D':best===u?'U':'L';
    }}
    let i=n,j=m,ops=[]; while(i>0||j>0){ const mv=bt[i][j];
      if(mv==='D'){ ops.push({type:a[i-1]===b[j-1]?'EQ':'SUB', a:a[i-1], b:b[j-1]}); i--; j--; }
      else if(mv==='U'){ ops.push({type:'DEL', a:a[i-1], b:''}); i--; }
      else { ops.push({type:'INS', a:'', b:b[j-1]}); j--; }
    }
    ops.reverse(); return {distance:dp[n][m], ops, baseLen:Math.max(1,a.length)};
  }
  function renderDiffHTML(targetRaw, heardRaw){
    const {distance, ops, baseLen}=diffAlign(targetRaw, heardRaw);
    const A=[], B=[];
    for(const op of ops){
      if(op.type==='EQ'){ A.push(`<span class="ok">${op.a}</span>`); B.push(`<span class="ok">${op.b}</span>`); }
      else if(op.type==='SUB'){ A.push(`<span class="highlight" title="æ‡‰ç‚ºï¼š${op.a}">${op.a}</span>`); B.push(`<span class="highlight" title="è¾¨ç‚ºï¼š${op.b}">${op.b}</span>`); }
      else if(op.type==='DEL'){ A.push(`<span class="highlight" title="æœªå”¸å‡ºï¼š${op.a}">${op.a}</span>`); B.push(`<span class="highlight" title="æœªå”¸å‡º">âˆ…</span>`); }
      else if(op.type==='INS'){ A.push(`<span class="highlight" title="å¤šå”¸">âˆ…</span>`); B.push(`<span class="highlight" title="å¤šå”¸ï¼š${op.b}">${op.b}</span>`); }
    }
    const pct=Math.round(Math.max(0,1-distance/baseLen)*100);
    const html=`<div class="row"><span class="label">ä¾‹å¥ï¼š</span>${A.join('')}</div><div class="row"><span class="label">è¾¨è­˜ï¼š</span>${B.join('')}</div>`;
    return { html, pct };
  }
  function feedbackByScore(pct){
    if (pct>=95) return "å¤ªæ£’äº†ï¼å¹¾ä¹å®Œå…¨æ­£ç¢ºï¼Œç¶­æŒæ¸…æ™°çš„å’¬å­—èˆ‡ç©©å®šçš„èªé€Ÿã€‚";
    if (pct>=85) return "å¾ˆä¸éŒ¯ï¼å†æ³¨æ„å€‹åˆ¥å­—çš„æ”¶å°¾èˆ‡é€£éŸ³ï¼Œæ”¾æ…¢ä¸€é»æ›´ç©©ã€‚";
    if (pct>=70) return "æœ‰é€²æ­¥ï¼å»ºè­°å…ˆè·Ÿè‘—ç¤ºç¯„æ…¢é€Ÿæœ—è®€ï¼Œé‡å°é«˜å…‰å­—å¤šç·´å¹¾æ¬¡ã€‚";
    if (pct>=50) return "åˆ¥æ€¥ï¼Œå…ˆåˆ†æ®µæœ—è®€ä¸¦é‡è¤‡ç·´ç¿’ï¼Œå†å®Œæ•´æœ—è®€ä¸€æ¬¡ã€‚";
    return "åŠ æ²¹ï¼å…ˆè½ç¤ºç¯„å…©éï¼Œé€å­—è·Ÿè®€ï¼Œç¢ºèªæ¯å€‹å­—éƒ½æœ‰ç™¼åˆ°ä½ã€‚";
  }
  function quizOverallFeedback(totalPct){
    if (totalPct>=95) return { zh:"å¤ªæ£’äº†ï¼å¹¾ä¹å®Œå…¨æ­£ç¢ºï¼Œç¶­æŒæ¸…æ™°çš„å’¬å­—èˆ‡ç©©å®šçš„èªé€Ÿã€‚", en:"Excellent! Nearly perfect accuracyâ€”keep your articulation clear and pace steady." };
    if (totalPct>=85) return { zh:"å¾ˆä¸éŒ¯ï¼å†æ³¨æ„å€‹åˆ¥å­—çš„æ”¶å°¾èˆ‡é€£éŸ³ï¼Œæ”¾æ…¢ä¸€é»æ›´ç©©ã€‚", en:"Great work! Watch final consonants and liaison; a slightly slower pace adds stability." };
    if (totalPct>=70) return { zh:"æœ‰é€²æ­¥ï¼å»ºè­°è·Ÿè‘—ç¤ºç¯„æ…¢é€Ÿæœ—è®€ï¼Œé‡å°é«˜å…‰å­—å¤šç·´å¹¾æ¬¡ã€‚", en:"Good progress! Shadow the demo slowly and practice the highlighted characters." };
    if (totalPct>=50) return { zh:"åˆ¥æ€¥ï¼Œå…ˆåˆ†æ®µæœ—è®€ä¸¦é‡è¤‡ç·´ç¿’ï¼Œå†å®Œæ•´æœ—è®€ä¸€æ¬¡ã€‚", en:"Don't rushâ€”read in chunks, repeat, then attempt a full read." };
    return { zh:"åŠ æ²¹ï¼å…ˆè½ç¤ºç¯„å…©éï¼Œé€å­—è·Ÿè®€ï¼Œç¢ºèªæ¯å€‹å­—éƒ½æœ‰ç™¼åˆ°ä½ã€‚", en:"Keep at it! Listen twice, echo word-by-word, and ensure each syllable lands." };
  }

  function refreshLessonOptions(){
    const sel=document.getElementById("lessonMulti");
    sel.innerHTML="";
    Object.keys(lessons).forEach(k=>{ const o=document.createElement("option"); o.value=k; o.textContent=`${k}ï¼ˆ${lessons[k].length} å¥ï¼‰`; sel.appendChild(o); });
  }
  function renderLessonStats(){
    const box=document.getElementById("lessonStats"); box.innerHTML="";
    Object.entries(lessons).forEach(([k,arr])=>{ const span=document.createElement("span"); span.className="pill"; span.textContent=`${k}ï¼š${(arr||[]).length} å¥`; box.appendChild(span); });
  }
  refreshLessonOptions(); 
  renderLessonStats();

  function getSelectedLessons(){
    const sel=document.getElementById("lessonMulti"); return Array.from(sel.selectedOptions).map(o=>o.value);
  }
  function selectAllLessons(){
    const sel=document.getElementById("lessonMulti"); Array.from(sel.options).forEach(o=>o.selected=true);
  }
  function clearLessons(){
    const sel=document.getElementById("lessonMulti"); Array.from(sel.options).forEach(o=>o.selected=false);
  }

  let currentSentence=""; let rec=null;
  const practiceRecords=[];
  function poolFromSelected(){
    const keys=getSelectedLessons(); const pool=[]; keys.forEach(k=>{ (lessons[k]||[]).forEach(s=>pool.push([k,s])); }); return pool;
  }
  function newSentence(){
    const pool=poolFromSelected(); if(pool.length===0){ alert("è«‹å…ˆé¸æ“‡è‡³å°‘ä¸€å€‹èª²æ¬¡ã€‚"); return; }
    const [key, s]=pool[Math.floor(Math.random()*pool.length)];
    currentSentence=s; document.getElementById("sentence").innerText=`ï¼ˆ${key}ï¼‰${s}`;
    document.getElementById("result").innerText="å°šç„¡çµæœ";
    document.getElementById("diff").innerText="å°šç„¡çµæœ";
    document.getElementById("accuracy").innerText="â€”";
    document.getElementById("feedback").innerText="";
  }
  function playSentence(){
    if(!currentSentence){ alert("è«‹å…ˆç”Ÿæˆå¥å­ï¼"); return; }
    const u=new SpeechSynthesisUtterance(currentSentence); u.lang="zh-TW"; speechSynthesis.cancel(); speechSynthesis.speak(u);
  }

  function startRecognition(){
    if(!('webkitSpeechRecognition'in window)){ alert("æ­¤ç€è¦½å™¨ä¸æ”¯æ´èªéŸ³è¾¨è­˜ï¼Œè«‹ä½¿ç”¨ Chromeã€‚"); return; }
    if(!currentSentence){ alert("è«‹å…ˆæŒ‰ã€Œæ›ä¸€å¥ã€ç”Ÿæˆå¥å­ï¼"); return; }
    rec=new webkitSpeechRecognition(); rec.lang="zh-TW"; rec.continuous=false; rec.interimResults=false; 
    rec.onresult=function(e){
      const heard=e.results[0][0].transcript||"";
      document.getElementById("result").innerText=heard;
      const {html,pct}=renderDiffHTML(currentSentence, heard);
      document.getElementById("diff").innerHTML=html;
      document.getElementById("accuracy").innerText=pct+"%";
      document.getElementById("feedback").innerText=feedbackByScore(pct);
      const name=document.getElementById("studentName").value.trim();
      const sid=document.getElementById("studentId").value.trim();
      practiceRecords.push({ time:nowString(), name, sid, sentence:currentSentence, recognized:heard, accuracy:pct, feedback:feedbackByScore(pct) });
      toggleRecButtons(false);
    };
    rec.onend=function(){ toggleRecButtons(false); };
    rec.start(); toggleRecButtons(true);
  }
  function stopRecognition(){
    if(rec){ try{ rec.stop(); }catch(e){} }
    toggleRecButtons(false);
  }
  function toggleRecButtons(recording){
    document.getElementById("btnStart").disabled=recording;
    document.getElementById("btnStop").disabled=!recording;
  }

  function downloadTxt(){
    if(practiceRecords.length===0){ alert("å°šç„¡æˆç¸¾å¯ä¸‹è¼‰ã€‚è«‹å…ˆå®Œæˆä¸€æ¬¡éŒ„éŸ³ç·´ç¿’ã€‚"); return; }
    const lines=["ã€ä¸­æ–‡å£èªå³æ™‚æ¯”å°ï½œç·´ç¿’æˆç¸¾å–®ï¼ˆå…§å»ºç‰ˆï¼‰ã€‘",`åŒ¯å‡ºæ™‚é–“ï¼š${nowString()}`,"","å§“å\tå­¸è™Ÿ\tæ™‚é–“\tä¾‹å¥\tè¾¨è­˜çµæœ\tæ­£ç¢ºç‡(%)\tå»ºè­°èˆ‡å›é¥‹"];
    const clean=s=>(s||"").replace(/\r?\n/g," ").trim();
    practiceRecords.forEach(r=>lines.push(`${clean(r.name)}\t${clean(r.sid)}\t${r.time}\t${clean(r.sentence)}\t${clean(r.recognized)}\t${r.accuracy}\t${clean(r.feedback)}`));
    const blob=new Blob(["\uFEFF"+lines.join("\n")],{type:"text/plain;charset=utf-8;"}), url=URL.createObjectURL(blob);
    const a=document.createElement("a"); a.href=url; a.download="practice_results.txt"; a.click(); URL.revokeObjectURL(url);
  }

  let quizQueue=[], quizIndex=-1, quizHeard="", quizRec=null;
  const quizRecords=[];
  function setQuizState(t){ document.getElementById("quizState").innerText=t; }
  function startQuiz(){
    const pool=poolFromSelected().map(([k,s])=>s); if(pool.length<1){ alert("è«‹å…ˆé¸æ“‡è‡³å°‘ä¸€å€‹èª²æ¬¡ã€‚"); return; }
    quizQueue=[]; const temp=[...pool];
    for(let i=0;i<3;i++){ if(temp.length===0) break; const idx=Math.floor(Math.random()*temp.length); quizQueue.push(temp.splice(idx,1)[0]); }
    if(quizQueue.length<3){ while(quizQueue.length<3 && pool.length>0) quizQueue.push(pool[Math.floor(Math.random()*pool.length)]); }
    quizRecords.length=0; quizIndex=-1; quizHeard=""; document.getElementById("quizSummary").style.display="none"; document.getElementById("quizFeedback").innerText="â€”";
    setQuizState("å·²æŠ½é¡Œï¼ŒæŒ‰ã€Œé–‹å§‹éŒ„éŸ³ã€å¾Œä½œç­”ï¼Œå®Œæˆè«‹æŒ‰ã€Œæäº¤æœ¬é¡Œã€ã€‚"); nextQuiz();
  }
  function nextQuiz(){
    quizIndex++; if(quizIndex>=quizQueue.length){ finishQuiz(); return; }
    const s=quizQueue[quizIndex]; document.getElementById("quizSentence").innerText=`ç¬¬ ${quizIndex+1} é¡Œï¼š${s}`;
    document.getElementById("quizHeard").innerText="â€”"; document.getElementById("quizDiff").innerText="ï¼ˆé«˜å…‰å·®ç•°æœƒé¡¯ç¤ºåœ¨é€™è£¡ï¼‰"; quizHeard="";
    setQuizState(`ä½œç­”ä¸­ï¼ˆç¬¬ ${quizIndex+1}/3 é¡Œï¼‰`);
  }
  function quizPlay(){ const txt=quizQueue[quizIndex]; if(!txt){ alert("è«‹å…ˆé–‹å§‹æ¸¬é©—ã€‚"); return; } const u=new SpeechSynthesisUtterance(txt); u.lang="zh-TW"; speechSynthesis.cancel(); speechSynthesis.speak(u); }
  function quizRecord(){
    if(!('webkitSpeechRecognition'in window)){ alert("æ­¤ç€è¦½å™¨ä¸æ”¯æ´èªéŸ³è¾¨è­˜ï¼Œè«‹ä½¿ç”¨ Chromeã€‚"); return; }
    const txt=quizQueue[quizIndex]; if(!txt){ alert("è«‹å…ˆé–‹å§‹æ¸¬é©—ã€‚"); return; }
    quizRec=new webkitSpeechRecognition(); quizRec.lang="zh-TW"; quizRec.continuous=false; quizRec.interimResults=false; quizRec.onresult=function(e){ quizHeard=e.results[0][0].transcript||""; document.getElementById("quizHeard").innerText=quizHeard||"ï¼ˆæœªå–å¾—è¾¨è­˜ï¼‰"; const {html}=renderDiffHTML(txt,quizHeard); document.getElementById("quizDiff").innerHTML=html; toggleQuizRecButtons(false); }; quizRec.onend=function(){ toggleQuizRecButtons(false); }; quizRec.start(); toggleQuizRecButtons(true);
  }
  function quizStop(){
    if(quizRec){ try{ quizRec.stop(); }catch(e){} }
    toggleQuizRecButtons(false);
  }
  function toggleQuizRecButtons(recording){
    document.getElementById("btnQuizStart").disabled=recording;
    document.getElementById("btnQuizStop").disabled=!recording;
  }
  function quizSubmit(){
    const txt=quizQueue[quizIndex]; if(!txt){ alert("è«‹å…ˆé–‹å§‹æ¸¬é©—ã€‚"); return; }
    if(!quizHeard){ alert("è«‹å…ˆéŒ„éŸ³å†æäº¤æœ¬é¡Œã€‚"); return; }
    const {html,pct}=renderDiffHTML(txt, quizHeard);
    quizRecords.push({ idx:quizIndex+1, sentence:txt, recognized:quizHeard, pct, diffHTML:html });
    nextQuiz();
  }
  function finishQuiz(){
    setQuizState("æ¸¬é©—å®Œæˆ");
    const total=Math.round(quizRecords.reduce((s,r)=>s+r.pct,0)/quizRecords.length);
    document.getElementById("quizTotal").innerText=total+"%";
    const fb=quizOverallFeedback(total); document.getElementById("quizFeedback").innerText=`${fb.zh} / ${fb.en}`;
    const name=(document.getElementById("studentName").value||"").trim();
    const sid=(document.getElementById("studentId").value||"").trim();
    const who=(name||sid)? `${name} / ${sid}` : "ï¼ˆæœªå¡«ï¼‰";
    document.getElementById("quizWho").innerText = who;
    const tbody=document.querySelector("#quizTable tbody"); tbody.innerHTML="";
    quizRecords.forEach(r=>{ const tr=document.createElement("tr"); tr.innerHTML=`<td>${r.idx}</td><td>${r.diffHTML}</td><td>${r.pct}%</td>`; tbody.appendChild(tr); });
    document.getElementById("quizSummary").style.display="block";
  }

  function downloadQuizTXT(){
    if(quizRecords.length!==3){ alert("è«‹å…ˆå®Œæˆä¸€æ¬¡ 3 é¡Œçš„æ¸¬é©—ã€‚"); return; }
    const total=Math.round(quizRecords.reduce((s,r)=>s+r.pct,0)/quizRecords.length), fb=quizOverallFeedback(total);
    const name=(document.getElementById("studentName").value||"").trim();
    const sid=(document.getElementById("studentId").value||"").trim();
    const lines=["ã€ä¸­æ–‡å£èªå³æ™‚æ¯”å°ï½œæœ¬æ¬¡æ¸¬é©—ï¼ˆå…§å»ºç‰ˆï¼‰ã€‘",`åŒ¯å‡ºæ™‚é–“ï¼š${nowString()}`,`å§“åï¼š${name}`,`å­¸è™Ÿï¼š${sid}`,`ç¸½æ­£ç¢ºç‡ï¼š${total}%`,`ç¸½è©•ï¼ˆä¸­æ–‡ï¼‰ï¼š${fb.zh}`,`Overall Feedback (EN): ${fb.en}`,"","é¡Œæ¬¡\tä¾‹å¥\tè¾¨è­˜çµæœ\tæ­£ç¢ºç‡(%)"];
    const clean=s=>(s||"").replace(/\r?\n/g," ").trim();
    quizRecords.forEach(r=>lines.push(`${r.idx}\t${clean(r.sentence)}\t${clean(r.recognized)}\t${r.pct}`));
    const blob=new Blob(["\uFEFF"+lines.join("\n")],{type:"text/plain;charset=utf-8;"}), url=URL.createObjectURL(blob);
    const a=document.createElement("a"); a.href=url; a.download="quiz_results.txt"; a.click(); URL.revokeObjectURL(url);
  }
  function downloadQuizCSV(){
    if(quizRecords.length!==3){ alert("è«‹å…ˆå®Œæˆä¸€æ¬¡ 3 é¡Œçš„æ¸¬é©—ã€‚"); return; }
    const total=Math.round(quizRecords.reduce((s,r)=>s+r.pct,0)/quizRecords.length), fb=quizOverallFeedback(total);
    const name=(document.getElementById("studentName").value||"").trim();
    const sid=(document.getElementById("studentId").value||"").trim();
    const rows=[["é¡Œæ¬¡","ä¾‹å¥","è¾¨è­˜çµæœ","æ­£ç¢ºç‡(%)"].join(",")];
    const esc = s => '"' + String(s || "").replace(/"/g,'""') + '"';
    quizRecords.forEach(r=>rows.push([r.idx, esc(r.sentence), esc(r.recognized), r.pct].join(",")));
    rows.push(["", "", "", ""].join(","));
    rows.push(["å§“å", name, "", ""].join(","));
    rows.push(["å­¸è™Ÿ", sid, "", ""].join(","));
    rows.push(["ç¸½æ­£ç¢ºç‡(%)", total, "", ""].join(","));
    rows.push(["ç¸½è©•(ä¸­æ–‡/EN)", esc(fb.zh+" / "+fb.en), "", ""].join(","));
    const csv="\uFEFF"+rows.join("\n"); const blob=new Blob([csv],{type:"text/csv;charset=utf-8;"}), url=URL.createObjectURL(blob);
    const a=document.createElement("a"); a.href=url; a.download="quiz_results.csv"; a.click(); URL.revokeObjectURL(url);
  }
</script>
</body>
</html>
